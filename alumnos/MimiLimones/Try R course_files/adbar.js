(function(){"use strict";window.microsoft||(window.microsoft={});var n=window.microsoft;n.createNS=function(n,t){var u,r,i;if(typeof n!="string"||n.length===0)throw new Error("Namespace has to be not empty string.");for(t=t||window,u=n.split("."),r=0;r<u.length;r++){i=u[r],typeof t[i]=="undefined"&&(t[i]={});if(typeof t[i]!="object")throw new Error("Namespace cannot be create, part of it already exists and it is not an object.");t=t[i]}return t},n.getNS=function(n,t){var u,i,r;if(typeof n!="string"||n.length===0)throw new Error("Namespace has to be not empty string.");for(t=t||window,u=n.split("."),i=0;i<u.length;i++){r=u[i];if(typeof t[r]!="object")return null;t=t[r]}return t},n.doesNSExist=function(t,i){return n.getNS(t,i)!==null},n.getCtor=function(t,i){if(typeof t!="string"||t.length===0)throw new Error("Constructor has to be not empty string.");i=i||window;if(t.indexOf(".")>-1){var r=t.split(".");t=r[r.length-1],i=n.getNS(r.slice(0,r.length-1).join("."),i)}if(i===null)throw new Error("Constructor cannot be fetched, namespace does not exist.");if(typeof i[t]!="function")throw new Error("Constructor cannot be fetched, it is not a function.");return i[t]}})();(function(){"use strict";var n=window.microsoft.createNS("adbar.renderers.UI");n.useSDN=!1,n.showIAF=!1,n.autoRefreshInterval=null,n.CONTENTNOTAVAILABLE="Content is not available. Please check back later.",n.SHARE="Share",n.VIEW="View",n.FINDLOCATION="Find a location near you",n.ADDRESS="Address",n.SEARCH="Search",n.FINDUS="Find Us",n.LOCATORSEARCHURL="http://www.bing.com/local/default.aspx?what={querystring}&where={address}&mkt=en-us",n.ADCHOICES="AdChoices",n.ADCHOICESGLINK="http://g.msn.com/AIPRIV/en-us?adchc=1",n.IAFCHECKTOOLTIP="More ads like this.",n.IAFXTOOLTIP="Don't like this ad.",n.IAFTHANKS="Thanks!",n.FEEDBACKHELPS="Your feedback helps us improve your ad experiences.",n.TELLUSMORELINK="",n.TELLUSMORELINKTEXT="",n.TELLUSMORETEXT=""})();window.microsoft.createNS("microsoft.advertising").DepMngr=function(){"use strict";function r(n,t){this.name=n,this.file=t,this.deps=[],this.exe=null,this.deferred=null}function s(i,f){var e,s,o;if(!i)throw new Error("Invalid Dependency Map: "+i);f=f||"",f&&f.charAt(f.length-1)!=="/"&&(f+="/");for(e in i)i.hasOwnProperty(e)&&(s=i[e],o=f+s.f,n[e]&&(n[e].file===o||t[o])||(n[e]=new r(e,o,u)))}function h(t,i,f){n[t]||(n[t]=new r(t,"unknown",u)),n[t].deps=i,n[t].updateExe(f)}function u(n){return typeof t[n]=="undefined"&&(t[n]=jQuery.ajax({url:n,dataType:"script",cache:!0,crossDomain:!0})),t[n]}function l(t,i,r){if(t.length===0){i();return}var u="",f=jQuery.map(t,function(t){return n[t]||(u="Definition of module ("+t+") could not be found"),n[t]});if(u!==""&&r){r(u);return}jQuery.when.apply(null,jQuery.map(f,function(n){return n.execute()})).then(function(){i.apply(null,arguments)},function(n){r&&r(n)})}function a(n,t){var u={timeout:1e3,dataType:"script",cache:!0},f=new jQuery.Deferred,r;if(i.hasOwnProperty(n))f.resolve(i[n]);else{r="msadscb"+Math.floor(Math.random()*100);while(typeof window[r]!="undefined")r="msadscb"+Math.floor(Math.random()*100);window[r]=function(t){i[n]=t,f.resolve(t),delete window[r]},t&&(u.dataType="jsonp",t.cbParamName&&(u.jsonp=t.cbParamName),t.cbValueName?u.jsonp=t.cbValueName:u.jsonpCallback=r,u.failure=function(){f.reject()}),jQuery.ajax(n,u)}return f.promise()}function v(){t={},n={},i={}}var o;r.prototype.updateExe=function(n){this.exe=n,this.deferred&&this.deferred.state()!=="pending"&&(this.deferred=null)},r.prototype.execute=function(){function t(){i.load(n.deps,function(){try{n.crux=n.exe.apply(null,arguments),n.deferred.resolve(n.crux)}catch(t){n.deferred.reject("Module ("+n.name+"): "+t.message)}},function(t){n.deferred.reject(t)})}var n=this,i=f;return this.deferred===null&&(this.deferred=new jQuery.Deferred,n.exe?t():i.getScript(n.file).then(t,function(t){n.deferred.reject(t)})),this.deferred.promise()};var n={},t={},i={};var f={configure:s,define:h,getScript:u,load:l,getExternalScript:a,reset:v},e=new jQuery.Deferred,c=e.promise();return e.resolve(),t.core=c,o={"helpers.utils":{d:[],f:"core"},"helpers.Validator":{d:[],f:"core"},"helpers.GuidGenerator":{d:[],f:"core"},"core.EventManager":{d:[],f:"core"},"core.Widget":{d:["core.EventManager","helpers.utils"],f:"core"},"core.TileWidget":{d:["core.Widget","helpers.utils"],f:"core"},"core.ExpandableTileWidget":{d:["core.TileWidget","helpers.utils"],f:"core"},"core.FlyoutWidget":{d:["core.Widget","helpers.utils"],f:"core"},"core.AdFooter":{d:["core.TileWidget","helpers.utils"],f:"core"},"core.FeedbackWidget":{d:["core.TileWidget","helpers.utils"],f:"core"},"core.AdNoticeTile":{d:["core.ExpandableTileWidget","helpers.utils"],f:"core"},"core.AdNoticeFlyout":{d:["core.FlyoutWidget","helpers.utils"],f:"core"}},s(o),f}();(function(){"use strict";function o(n){var u="",f=t.anid,i,r;f&&(u+="&ANID="+f);for(i in n)n.hasOwnProperty(i)&&i!=="_meta"&&(r=n[i],r&&(u+="&"+i+"="+encodeURIComponent(r.toString())));return u}function s(n,t){var i=Math.round(t/1e3);return n=n.replace(f,"$1"+i+"$3"),n.match(f)||(n+=n.lastIndexOf("?")>-1?"&":"?",n+="AN="+i),n}function r(t){var f,u,y,v,p;t.ExceptionType?(u=a,f=n[u]):(u=t.Control+t.Action,f=n[u],f||(u=t.Action,f=n[u]));if(!f)return;var b,e,r,w=t._meta||{},g=!!w._once,k=!!w._tpt,d=!!w._noAsid;if(g&&i[u])return;i[u]=!0,y=f.tr,v=f.tpt;if(!k&&y){p=+new Date,b=o(t),b+="&Timestamp="+p,e=y.length;while(e--){r=y[e];if(!r)continue;l[u]&&(r=r.replace(h,"$1_$3")),r=s(r+b,p),d&&(r=r.replace(c,"$1$4")),window.ORMMA.request(r,"ignore")}}if(v){e=v.length;while(e--)window.ORMMA.request(v[e],"ignore")}}var e=window.microsoft.createNS("microsoft.advertising.Logger"),f=/(.*&AN=|.*?AN=)(\w*)($|&.*)/gi,c=/(.*)(ASID=\w*&?(amp;)?)(.*)/i,h=/^(([^\/]*\/){3})([^_].*)/,t,n,u=!1,i={},l={click:!0,mouseenter:!0,loading:!0,loaded:!0,cancelclick:!0,onerror:!0,previewclick:!0,previewmouseenter:!0,shareclick:!0,videoplay:!0,directionsclick:!0},a="onerror";e.refresh=function(r,f){n=r||{},t=f||{},i={},u=!0},e.logEvent=function(n){if(!u||!t.enableGLog||!n)return;if(n instanceof Array){var i=n.length;while(i--)r(n[i])}else r(n)}})();window.microsoft.advertising.DepMngr.define("core.EventManager",[],function(){"use strict";function n(t,i,r){if(!r){if(!(this instanceof n))return new n(t,i);if(!t)throw new Error("InvalidArgumentException: 'eventsToFire' was null or undefined");this.init(t,i)}}var t={add:function(n){return Array.prototype.push.apply(n,Array.prototype.slice.call(arguments,1))},remove:function(n,i){var r=t.inArray(i,n),u;return r<0?n.length:(u=n.slice(r+1),n.length=r,Array.prototype.push.apply(n,u))},contains:function(n,i){return t.inArray(i,n)!==-1},inArray:function(n,t){if(t.indexOf)return t.indexOf(n);for(var i=0,r=t.length;i<r;i++)if(t[i]===n)return i;return-1}};return n.prototype._isValidEvent=function(n){return typeof n!="string"||!t.contains(this._eventsToListen,n)?!1:!0},n.prototype._resolveListener=function(n){var t=n;return typeof t!="function"&&(t=null),t},n.prototype._getListenersForEvent=function(n){return this._eventListeners[n]},n.prototype.init=function(n,t){var r,i;if(this._isInited)return;if(!n||typeof n!="object")throw new Error("Events to fire are not in correct format");r=this._eventsToListen=[],this._eventListeners={},this._eventObjectsList=n,this._isInited=!0,this._initializer=t;for(i in n)n[i]&&n[i].name&&r.push(n[i].name)},n.prototype.invokeEventListeners=function(n){var t=[n,null,null,!0];t=t.concat(Array.prototype.slice.call(arguments,1)),this.fireEvent.apply(this,t)},n.prototype.fireEvent=function(n,t,i,r){var u,o;if(!this._isValidEvent(n))return;var s=null,e=null,f=this._getListenersForEvent(n);if(!f)return;for(u in this._eventObjectsList)if(this._eventObjectsList[u].name===n&&this._eventObjectsList[u].category){s=this._eventObjectsList[u].category;break}for(e=r?Array.prototype.slice.call(arguments,4):{category:s,name:n,data:i,currentTarget:t,target:this._initializer},o=f.length,u=0;u<o;u++)try{r?f[u].apply(null,e):f[u](e)}catch(h){}},n.prototype.addEventListener=function(n,i){if(!this._isInited)throw new Error("EventManager is not inlitialized.");if(this._isValidEvent(n)){var u=this._resolveListener(i),r=this._getListenersForEvent(n);r||(r=[],this._eventListeners[n]=r),u&&r&&t.add(r,u)}},n.prototype.removeEventListener=function(n,i){if(!this._isInited)throw new Error("EventManager is not inlitialized.");if(this._isValidEvent(n)){var u=this._resolveListener(i),r=this._getListenersForEvent(n);u&&r&&t.remove(r,u)}},n.prototype.getEventsList=function(){return this._eventsToListen?this._eventsToListen:null},n.prototype.getEventObjectsList=function(){return this._eventObjectsList?this._eventObjectsList:null},n.prototype.destroy=function(){this._eventObjectsList=[],this._eventsToListen=[],this._eventListeners={},this._isInited=!1,this._initializer=null},window.microsoft.createNS("microsoft.advertising.lib.events").eventManager=function(){return new n(null,null,!0)},n});(function(){"use strict";function wt(){var t=[],n;for(n in u)u.hasOwnProperty(n)&&t.push({name:u[n]});return t}var e=null,f=null,r=null,n={LOADING:"loading",DEFAULT:"default",RESIZED:"resized",EXPANDED:"expanded",HIDDEN:"hidden",SUSPENDED:"suspended"},u={STATECHANGE:"stateChange",SIZECHANGE:"sizeChange",ERROR:"error",ADERROR:"adError",ASSETREADY:"assetReady",ASSETREMOVED:"assetRemoved",ASSETRETIRED:"assetRetired",INFO:"info",HEADING:"heading",HEADINGCHANGE:"headingChange",KEYBOARD:"keyboard",KEYBOARDCHANGE:"keyboardChange",LOCATION:"location",LOCATIONCHANGE:"locationChange",NETWORK:"network",NETWORKCHANGE:"networkChange",ORIENTATION:"orientation",ORIENTATIONCHANGE:"orientationChange",READY:"ready",RESPONSE:"response",SCREEN:"screen",SCREENCHANGE:"screenChange",SHAKE:"shake",STATE:"state",TILT:"tilt",TILTCHANGE:"tiltChange",VIEWABLECHANGE:"viewableChange"},yt={BACK:"back",FORWARD:"forward",REFRESH:"refresh",ALL:"all"},h={LEVEL1:"level-1",LEVEL2:"level-2",LEVEL3:"level-3",SCREEN:"screen",ORIENTATION:"orientation",HEADING:"heading",LOCATION:"location",SHAKE:"shake",TILT:"tilt",NETWORK:"network",SMS:"sms",PHONE:"phone",EMAIL:"email",CALENDAR:"calendar",CAMERA:"camera",MAP:"map",AUDIO:"audio",VIDEO:"video"},it={OFFLINE:"offline",WIFI:"wifi",CELL:"cell",UNKNOWN:"unknown"},p="pixelContainerId",o,s=!1,w,i=function(){var u=!1,i=null,t=null,c=function(){if(!u)throw new Error("StateManager$_checkIsInited: StateManager not inited");},r=function(){c()},f=function(t){var r,i;if(typeof t!="string")throw new Error("StateManager$_checkPrereqs: state is not string");r=!1;for(i in n)if(n.hasOwnProperty(i))return i===t?(r=!0,!1):!0;if(!r)throw new Error("StateManager$_checkPrereqs: unknown state:"+t);},e=function(n){if(u)return;f(n),i=t=n,u=!0},s=function(u){r(),f(u);var e={isNotAllowed:!0,isChanged:!1,state:n.DEFAULT};switch(u){case n.DEFAULT:t===n.DEFAULT?(e.isNotAllowed=!1,e.isChanged=!1,e.state=t):(t===n.EXPANDED||t===n.SUSPENDED||t===n.HIDDEN)&&(i=t,t=u,e.isNotAllowed=!1,e.isChanged=!0,e.state=t);break;case n.EXPANDED:t===n.EXPANDED?(e.isNotAllowed=!1,e.isChanged=!1,e.state=t):(t===n.DEFAULT||t===n.HIDDEN)&&(i=t,t=u,e.isNotAllowed=!1,e.isChanged=!0,e.state=t);break;case n.RESIZED:e.isNotAllowed=!0,e.isChanged=!1,e.state=t;break;case n.HIDDEN:t===n.HIDDEN||t===n.LOADING||t===n.RESIZING?(e.isNotAllowed=!1,e.isChanged=!1,e.state=t):(t===n.DEFAULT||t===n.SUSPENDED)&&(i=t,t=u,e.isNotAllowed=!1,e.isChanged=!0,e.state=t);break;case n.SUSPENDED:t===n.HIDDEN||t===n.SUSPENDED?(e.isNotAllowed=!1,e.isChanged=!1,e.state=t):(i=t,t=u,e.isNotAllowed=!1,e.isChanged=!0,e.state=t)}return e},o=function(){return r(),t},h=function(){return r(),i};return{getState:o,getPreviousState:h,init:e,trackState:s}}(),c=function(){return t(),{width:e.width,height:e.height}},l=function(){return t(),{width:e.width+e.offsetLeft+e.offsetRight,height:e.height+e.offsetTop+e.offsetBottom}},bt=function(){if(!s)throw new Error("ORMMA$checkIsInited: ORMMA not inited");},t=function(){bt();if(!i)throw new Error("ORMMA$checkPrereqs: stateManager null");if(!r)throw new Error("ORMMA$checkPrereqs: eventListenerManager null");},y=function(){if(!i)throw new Error("ORMMA$checkPrereqsBeforeInit: stateManager null");if(!r)throw new Error("ORMMA$checkPrereqsBeforeInit: eventListenerManager null");},vt=function(n,t){y(),r.addEventListener(n,t)},kt=function(){t();var f=i.trackState(n.DEFAULT);if(f.isNotAllowed)return;f.isChanged&&r.invokeEventListeners(u.STATECHANGE,i.getState())},ti=function(){t();var f=i.trackState(n.EXPANDED);if(f.isNotAllowed)return;f.isChanged&&r.invokeEventListeners(u.STATECHANGE,i.getState())},dt=function(){t();var n=c();return{x:0,y:0,width:n.width,height:n.height}},tt=function(){return t(),w},rt=function(){t();var n=l();return{width:n.width,height:n.height}},g=function(){t();var u=i.getState(),r=null;return r=u===n.EXPANDED?l():c(),{width:r.width,height:r.height}},k=function(){return t(),i.getState()},b=function(){return t(),!0},ni=function(){t();var e=i.trackState(n.HIDDEN);if(e&&!e.isNotAllowed&&e.isChanged){r.invokeEventListeners(u.STATECHANGE,i.getState());if(f&&f.hide)try{f.hide()}catch(o){}}},st=function(n,i,r){var u,f,e;t();if(n)for(u=0;u<n.length;u++)microsoft.advertising.products.common.loadCss(n[u]);f=null,microsoft.advertising.products.common.doesObjectExist("microsoft.advertising.products.dependencyManager","function")&&(f=microsoft.advertising.products.dependencyManager()),e=[];if(f&&i){for(u=0;u<i.length;u++)e.push({type:"js",url:i[u],async:!1});f.addDependencies(e),f.loadDependencies(r)}else r&&r()},ct=function(n){t(),window.open(n,"")},ft=function(){t()},ot=function(n,t){y(),r.removeEventListener(n,t)},et=function(n,i){t(),e.width=n,e.height=i,r.fireEvent(u.SIZECHANGE,null,{width:n,height:i})},ut=function(n,i,r){var u,e;i&&typeof i=="string"||(i=""),r&&typeof r=="string"||(r=""),t();if(f&&f.sendMail)f.sendMail(n,i,r);else{u=[],u.push("rru=compose"),u.push("subject="+encodeURIComponent(i)),u.push("body="+encodeURIComponent(r)),e="http://mail.live.com/default.aspx?"+u.join("&");if(e.length>2048)throw"url length is greater than 2048";else window.open(e,"","location=yes,toolbar=yes,menubar=yes,directories=yes,status=yes,resizable=yes,scrollbars=yes,height=undefined,width=undefined",!1)}},lt=function(n){t(),w=n},ht=function(){t();var f=i.trackState(n.DEFAULT);i.getPreviousState()==="hidden"&&a();if(f.isNotAllowed)return;f.isChanged&&r.invokeEventListeners(u.STATECHANGE,i.getState())},d=function(n){return n===h.LEVEL1||n===h.LEVEL2?!0:!1},nt=function(n){var t;if(s)return;n=n||{},t=n.wlOptions||{},n.PublisherObject&&(f=n.PublisherObject),f&&f.stateChangeListener&&typeof f.stateChangeListener=="function"&&r.addEventListener(u.STATECHANGE,f.stateChangeListener);if(typeof jQuery=="undefined")throw new Error("ORMMA$init: jQuery not available");if(!i)throw new Error("ORMMA$init: stateManager not found");if(!r)throw new Error("ORMMA$init: event listener manager not found");e={width:t.width||160,height:t.height||600,offsetLeft:t.offsetLeft||530,offsetRight:t.offsetRight||0,offsetTop:t.offsetTop||0,offsetBottom:t.offsetBottom||0},a(),s=!0,r.fireEvent(u.READY)},gt=function(){t();var f=i.trackState(n.SUSPENDED);if(f.isNotAllowed)return;f.isChanged&&r.invokeEventListeners(u.STATECHANGE,i.getState())},a=function(){o=document.getElementById(p);if(!o){var n=document.createElement("div");n.setAttribute("id",p),n.setAttribute("style","display:none;"),o=document.getElementsByTagName("body")[0].appendChild(n)}},pt=function(n,i){var f,e;return t(),!n||typeof n!="string"?!1:o===undefined?!1:(f=document.createElement("img"),f.setAttribute("height",1),f.setAttribute("width",1),i==="proxy"&&(e=function(){r.invokeEventListeners(u.RESPONSE,n,"")},f.addEventListener?(f.addEventListener("load",e,!1),f.addEventListener("error",e,!1)):f.attachEvent&&(f.attachEvent("onload",e),f.attachEvent("onerror",e))),f.setAttribute("src",n),o.appendChild(f),!1)},at=function(n,i){t(),r.fireEvent(u.ADERROR,null,{action:n,message:i})},v={STATES:n,EVENTS:u,CONTROLS:yt,FEATURES:h,NETWORK:it,init:nt,addEventListener:vt,close:kt,expand:ti,getDefaultPosition:dt,getExpandProperties:tt,getMaxSize:rt,getSize:g,getState:k,getViewable:b,hide:ni,loadDependencies:st,open:ct,openMap:ft,removeEventListener:ot,resize:et,sendMail:ut,setExpandProperties:lt,show:ht,supports:d,request:pt,suspend:gt,adError:at};i&&i.init(n.HIDDEN),window.microsoft.advertising.DepMngr.load(["core.EventManager"],function(n){r=new n(wt(),v),window.ORMMA=v})})();window.microsoft.advertising.DepMngr.define("helpers.utils",[],function(){"use strict";function i(n){var s=/(chrome)[ \/]([\w.]*)/,u=/(safari)[ \/]([\w.]*)/,o=/(opera)(?:.*version)?[ \/]([\w.]+)/,e=/(msie) ([\w.]+)/,h=/(firefox)[ \/]([\w.]*)/,r=null,f=null,i,t;return typeof n=="string"&&(t=n.toLowerCase(),i=s.exec(t)||u.exec(t)||o.exec(t)||e.exec(t)||t.indexOf("compatible")<0&&h.exec(t)||[],r=i[1]||null,f=i[2]||null),r&&r==="safari"&&(u=/(version)(?:.*version)?[ \/]([\w.]+)/,i=u.exec(t)||[],f=i[2]||null),{name:r,version:f}}var n,t;return Function.prototype.bind||(Function.prototype.bind=function(n){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var u=Array.prototype.slice.call(arguments,1),r=this,t=function(){},i=function(){return r.apply(this instanceof t?this:n,u.concat(Array.prototype.slice.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i}),n={},n.constants={DEF_CURR_SYM:"$",DEF_CURR_CODE:"USD"},n.applicationExceptions={CriticalError:"CriticalError",NoData:"NoData"},n.isUndefinedOrNull=function(n){return typeof n=="undefined"||n===null},n.mergeProperties=function(t,i,r){n.isUndefinedOrNull(r)&&(r=!1);for(var u in i)i.hasOwnProperty(u)&&(r&&typeof i[u]=="object"&&i[u]!==null&&t.hasOwnProperty(u)&&typeof t[u]=="object"&&t[u]!==null?n.mergeProperties(t[u],i[u],!0):t[u]=i[u]);return t},n.inherits=function(n,t){if(typeof n!="function")throw new Error("Constructor function for child class has to be provided.");if(typeof t!="function")throw new Error("Constructor function for parent class has to be provided.");var i=function(){};i.prototype=t.prototype,n.prototype=new i,n.uber=t.prototype,n.prototype.constructor=n},n.isUsingHttps=function(){return window.location.protocol.indexOf("https")===0},n.loadCss=function(n,t){if(typeof n!="string")return-1;var r=t&&t.document?t.document:document,i=r.createElement("link");return i.rel="stylesheet",i.type="text/css",i.href=n,i.media="all",r.getElementsByTagName("head")[0].appendChild(i),1},n.isCSS3Supported=function(){var f=document.body||document.documentElement,r=f.style,n="transition",i,t,u;if(typeof r[n]=="string")return!0;for(i=["Moz","Webkit","Khtml","O","ms"],n=n.charAt(0).toUpperCase()+n.substr(1),t=0,u=i.length;t<u;t++)if(typeof r[i[t]+n]=="string")return!0;return!1}(),n.isBrowserSupported=function(n){var f=!1,u,e,r,t;return n&&(t=i(n.toLowerCase()),t&&(e=t.name,r=parseFloat(t.version),u={msie:7,chrome:8,firefox:3.6,safari:5},f=r>=u[e])),f},n.truncate=function(n,t,i){if(n===null)return"";if(typeof n!="string")throw new Error("string expected");return i=i||"",n.length<=t?n:n.substring(0,t-i.length)+i},n.htmlDecode=function(n){if(typeof n!="string")return;if(n==="")return n;var t=document.createElement("div");return t.innerHTML=n,t.textContent||t.innerText},n.htmlEncode=function(n){if(typeof n!="string")return;var t=document.createElement("div");return t.appendChild(document.createTextNode(n)),t.innerHTML},n.ellipsizeHTML=function(t,i){var r=parseInt(i,10);if(typeof t!="string"||isNaN(r))throw new Error("Common$ellipsizeHTML:input error,str=["+t+"],maxLength=["+i+"]");return t.length<=r?t:n.htmlEncode(n.truncate(n.htmlDecode(t),r,"..."))},n.parseServerDateTime=function(n,t){if(typeof n!="string"||typeof t!="string")throw new Error("date and time parameters expected to be strings");var r=n.match(/\d+/gi),i=t.match(/\d+/gi),u=t.match(/(AM|PM|am|pm)$/gi);if(!r||r.length!==3||!i||i.length!==3)throw new Error("date and/or time is invalid");return u.toString().toLowerCase()==="pm"?i[0]!=="12"&&(i[0]=(Number(i[0])+12).toString()):i[0]==="12"&&(i[0]=0),new Date(Date.UTC(r[0],r[1]-1,r[2],i[0],i[1],i[2]))},n.parseJsonDate=function(n){var t=n.replace(/\/Date\((\d+)\)\//gi,"$1");return t=new Date(parseInt(t,10))},n.formatPhoneNumber=function(n){return typeof n!="string"&&(n=""+n),/^\d{10}$/.test(n)?"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6,4):n},n.isHTML5VideoSupported=function(){var n=document.createElement("video");if(typeof n.canPlayType=="function")if(n.canPlayType("video/mp4"))return!0;return!1}(),t=n.roundPriceToCents=function(n){var i=+n,t="";return n===null||isNaN(i)||(t=i.toFixed(2)),t},n.formatPrice=function(n){var u="",r,i;return n=t(n),n&&(i=n.split("."),u=i[0],r=i[1],r&&(u+="<span class='decimal'>"+r+"</span>")),u},n.getGaePropertyValue=function(n,t,i){var u="",f="",r;return n?(r=n[t],r&&(u=r.t,u&&(f=u==="txt"?r.tx:r.u)),i?u:f):f},n.getUrlWithProtocol=function(n){return n===""?n:n.substr(0,7)!=="http://"&&n.substr(0,8)!=="https://"?"http://"+n:n},n.getGaeProperty=function(n,t){if(!n)return"";var i=n[t];return i?i:""},n});window.microsoft.advertising.DepMngr.define("helpers.GuidGenerator",[],function(){"use strict";function n(){this._guid=null}return n.prototype._S4=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},n.prototype.getGuid=function(){return this._guid||(this._guid="ms_"+(this._S4()+this._S4()+"-"+this._S4()+"-"+this._S4()+"-"+this._S4()+"-"+this._S4()+this._S4()+this._S4()+"_")),this._guid},n.prototype.getElementById=function(n){var t=document.getElementById(this.getId(n));return t?t:document.getElementById(n)},n.prototype.getId=function(n){return this.getGuid()+n},n});window.microsoft.advertising.DepMngr.define("helpers.Validator",[],function(){"use strict";function t(n){var i=n,t=[],u=[],p=!1,s=function(n){return t.push(n)},f=function(){return t.pop()},r=function(){return t.length>0?t[t.length-1]:null},e=function(n){var t={obj:null,name:"",fallbackCallback:null,failureCallback:null,failed:!1,mode:"c"};switch(n){case"a":t.mode="a",t.aIndices=null,t.aIndex=-1,t.aLoopIndex=-1,t.rulesCallback=null;break;case"o":t.mode="o",t.oProps=null,t.oProp="",t.rulesCallback=null}return t},o=function(){var n=r();if(n===null)return i;switch(n.mode){case"c":return c();case"a":return l();case"o":return y()}return i},c=function(){var n=r(),f=n.obj,t=!0,u;return typeof f=="undefined"&&typeof n.fallbackCallback=="function"&&n.fallbackCallback!==null&&(t=!1,u=n.fallbackCallback(n.name),typeof u!="undefined"&&(n.obj=u,t=!0)),t||(n.failed=!0,h("is undefined.",n.failureCallback)),i},l=function(){var n=r(),t=n.obj,c=typeof t=="object"&&t!==null&&typeof t.length!="undefined"?t.length:1,u,h;return(n.aIndices===null||n.aIndices.length===0)&&(n.aLoopIndex===-1||n.aLoopIndex===c)?(f(),i):(u=e("c"),h=0,n.aLoopIndex>-1?h=n.aLoopIndex++:n.aIndices!==null&&n.aIndices.length>0&&(h=n.aIndex=n.aIndices.pop()),typeof t=="object"&&t!==null&&typeof t.length!="undefined"&&(u.obj=t[h]),u.name=n.name+"["+h+"]",u.failed=n.failed,u.fallbackCallback=n.fallbackCallback,u.failureCallback=n.failureCallback,s(u),n.rulesCallback!==null&&n.rulesCallback.apply(i,[i]),o())},y=function(){var n=r(),h=n.obj,t,u;return n.oProps===null||n.oProps.length===0?(f(),i):(t=e("c"),u=n.oProps.pop(),typeof h=="object"&&h!==null?t.obj=h[u]:n.oProps=[],t.name=n.name+"."+u,t.failed=n.failed,t.fallbackCallback=n.fallbackCallback,t.failureCallback=n.failureCallback,t.oProp=u,s(t),n.rulesCallback!==null&&n.rulesCallback.apply(i,[i]),o())},h=function(n,i){var f=r(),s,h,o,e;if(f===null)return;n=f.name+": "+n;if(i==="function"&&i!==null)try{i(f.obj,n)}catch(c){}if(typeof f.failureCallback=="function"&&f.failureCallback!==null&&f.failureCallback!==i)try{for(s=null,h=null,o=t.length-1;o>=0;o--){e=t[o];if(e.mode==="c")continue;if(e.mode==="a"){s=e.aLoopIndex===-1?e.aIndex:e.aLoopIndex-1;break}if(e.mode==="o"){h=e.oProp;break}}s!==null?f.failureCallback(f.obj,s,n):h!==null?f.failureCallback(f.obj,h,n):f.failureCallback(f.obj,n)}catch(c){}if(p){t=[],u.push(n);throw new Error(n);}u.push(n)},v=function(){return u},a=function(){t=[],u=[]};return{push:s,pop:f,peek:r,getDefaultInfoFor:e,processMode:o,handleFailure:h,getMessages:v,clear:a}}function n(){if(!this instanceof n)return new n(arguments);this._state=t(this)}return n.prototype.withOptions=function(n){return this.clear(),this._options=n||{},this._options.throwOnFailure=typeof n.throwOnFailure=="boolean"?n.throwOnFailure:!1,this},n.prototype.runOn=function(){var t=arguments,s,h,l,c,u;if(t.length===0)throw new Error("Arguments cannot be empty.");var r=this._state.peek(),n=this._state.getDefaultInfoFor("c"),o=null,e="data",f=1,i=t[0];if(typeof i=="string")if(r===null)o=i,e="data";else{if(i.length===0)throw new Error("First argument cannot be an empty string.");if(i.charAt(0)==="["){n=this._state.getDefaultInfoFor("a"),e=r.name;if(i.charAt(1)==="*"){n.aLoopIndex=0;if(typeof t[1]!="function"||t[1]===null)throw new Error("Validator internal error: callback function for batch processing cannot be missing.");n.rulesCallback=t[1],f=2}else{for(n.aIndices=[],s=i.split(","),h=s.length-1;h>=0;h--)n.aIndices.push(parseInt(s.slice(1,s.length-1),10));if(n.aIndices.length>1){if(typeof t[1]!="function"||t[1]===null)throw new Error("Validator internal error: callback function for batch processing cannot be missing.");n.rulesCallback=t[1],f=2}}}else{n=this._state.getDefaultInfoFor("o"),e=r.name;if(i.charAt(0)==="*"){n.oProps=[],l=r.obj;for(c in l)l.hasOwnProperty(c)&&n.oProps.push(c);if(typeof t[1]!="function"||t[1]===null)throw new Error("Validator internal error: callback function for batch processing cannot be missing.");n.rulesCallback=t[1],f=2}else{n.oProps=i.split(",");if(n.oProps.length>1){if(typeof t[1]!="function"||t[1]===null)throw new Error("Validator internal error: callback function for batch processing cannot be missing.");n.rulesCallback=t[1],f=2}}}o=r.obj,n.failed=r.failed}else o=i,e="data";if(n===null)throw new Error("Validator internal error: new stack info cannot be null.");return u=t[f],typeof u=="object"&&u!==null&&(n.fallbackCallback=u.fallbackCallback||n.fallbackCallback,n.failureCallback=u.failureCallback||n.failureCallback),n.obj=o,n.name=e,this._state.push(n),this._state.processMode()},n.prototype.back=function(){var n=this._state.peek();return n===null?this:(n.mode==="c"&&this._state.pop(),this._state.processMode())},n.prototype.isOfType=function(n,t){var i=this._state.peek(),u,r;return i===null?this:i.failed?this:(u=i.obj,r=typeof u,n==="array"?(i.failed=r!=="object"||u.constructor!==Array,i.failed&&this._state.handleFailure("is not an array: real type is '"+r+"'.",t)):(i.failed=r!==n,i.failed&&this._state.handleFailure("has incorrect type: expected type is '"+n+"', real type is '"+r+"'.",t)),this)},n.prototype.isObject=function(n){return this.isOfType("object",n)},n.prototype.isString=function(n){return this.isNotNull(),this.isOfType("string",n)},n.prototype.isNumber=function(n){return this.isNotNull(),this.isOfType("number",n)},n.prototype.isArray=function(n){return this.isNotNull(),this.isOfType("array",n)},n.prototype.isFunction=function(n){return this.isNotNull(),this.isOfType("function",n)},n.prototype.isBoolean=function(n){return this.isNotNull(),this.isOfType("boolean",n)},n.prototype.isNotNull=function(n){var t=this._state.peek(),i;return t===null?this:t.failed?this:(i=t.obj,t.failed=i===null,t.failed&&this._state.handleFailure("is null.",n),this)},n.prototype.stringIsNotEmpty=function(n){var t=this._state.peek(),i;return t===null?this:t.failed?this:(i=t.obj,t.failed=i.length===0,t.failed&&this._state.handleFailure("is an empty string.",n),this)},n.prototype.stringEqualsTo=function(n,t){var i=this._state.peek(),r;return i===null?this:i.failed?this:(r=i.obj,i.failed=r!==n,i.failed&&this._state.handleFailure("is not equal to expected string '"+n+"'.",t),this)},n.prototype.arrayHasItems=function(n){var t=this._state.peek(),i;return t===null?this:t.failed?this:(i=t.obj,i.length===0&&this._state.handleFailure("is an empty array.",n),this)},n.prototype.hasProperties=function(n,t){var u=this._state.peek(),i,r;if(u===null)return this;if(u.failed)return this;var o=u.obj,e=n.split(","),f=!1;for(i=0;i<e.length;i++)r=e[i],typeof o[r]=="undefined"&&(f||(f=!0),this._state.handleFailure("property '"+r+"' does not exist.",t));return this},n.prototype.isCreativeDataURLValid=function(){var u="t,u",i=this._state.peek(),t,n,r;this.isNotNull();if(i.failed)return this;this.isObject();if(i.failed)return this;if(i.failed)return this;for(t=u.split(","),n=0;n<t.length;n++)r=t[n],this.runOn(r).isString().stringIsNotEmpty().back();return this},n.prototype.apply=function(n,t){var r=this._state.peek(),i,u;if(r===null)return this;if(r.failed)return this;if(typeof n=="function"&&n!==null){i=null;try{i=n(r.name,r.obj)}catch(f){}i!==null&&typeof i=="object"&&i.failed&&(u=i.message||"message was not provided.",this._state.handleFailure(u,t))}return this},n.prototype.isValid=function(){return this._state.getMessages().length===0},n.prototype.getMessages=function(){return this._state.getMessages()},n.prototype.clear=function(){this._state.clear()},n});jQuery.fn.peekAnimate=function(n){"use strict";var t=jQuery.extend({direction:"up",peekUp:0,peekDown:-115,peekSpeed:200,closeButDelay:200,closeButSpeed:167,showCloseBut:!0},n),i=jQuery("html").hasClass("useCss3");return this.each(function(){var r=jQuery(this),n=r.find(".peek");t.peekDown=0-r.css("height").replace("px","")*1,i&&(n.css({"-webkit-transition":"all "+t.peekSpeed+"ms cubic-bezier(0,0,.58,1)","-moz-transition":"all "+t.peekSpeed+"ms cubic-bezier(0,0,.58,1)","-o-transition":"all "+t.peekSpeed+"ms cubic-bezier(0,0,.58,1)","-ms-transition":"all "+t.peekSpeed+"ms cubic-bezier(0,0,.58,1)",transition:"all "+t.peekSpeed+"ms cubic-bezier(0,0,.58,1)"}),r.find(".close").css({"-webkit-transition":"opacity "+t.closeButSpeed+"ms cubic-bezier(0, 0, 1, 1)","-moz-transition":"opacity "+t.closeButSpeed+"ms cubic-bezier(0, 0, 1, 1)","-o-transition":"opacity "+t.closeButSpeed+"ms cubic-bezier(0, 0, 1, 1)","-ms-transition":"opacity "+t.closeButSpeed+"ms cubic-bezier(0, 0, 1, 1)",transition:"opacity "+t.closeButSpeed+"ms cubic-bezier(0, 0, 1, 1)","-webkit-transition-delay":t.closeButDelay+"ms","-moz-transition-delay":t.closeButDelay+"ms","-o-transition-delay":t.closeButDelay+"ms","-ms-transition-delay":t.closeButDelay+"ms","transition-delay":t.closeButDelay+"ms"})),t.direction==="up"?i?(n.removeClass("down").addClass("up"),t.showCloseBut&&n.addClass("showClose")):(n.removeClass("jqDown").addClass("jqUp"),n.animate({bottom:t.peekUp},t.peekSpeed),t.showCloseBut&&(n.addClass("jqShowClose"),r.find(".close").delay(t.closeButDelay).fadeIn(t.closeButSpeed))):t.direction!=="down"||r.hasClass("on")||(i?(n.removeClass("up").addClass("down"),t.showCloseBut&&n.removeClass("showClose")):(n.removeClass("jqUp").addClass("jqDown"),n.animate({bottom:t.peekDown},t.peekSpeed),t.showCloseBut&&(n.removeClass("jqShowClose"),r.find(".close").fadeOut(t.closeButSpeed))))})};jQuery.fn.previewAnimate=function(n,t){"use strict";var i=jQuery.extend({direction:"open",movement:10,speed:167},n),r=jQuery("html").hasClass("useCss3");return this.each(function(){var n=jQuery(this);i.direction==="open"?r?n.show(0,function(){n.addClass("opened")}):n.hasClass("jqOpened")||n.addClass("jqOpened").fadeIn(i.speed):i.direction==="close"&&(r?n.hide().removeClass("opened"):n.hasClass("jqOpened")&&n.hide().removeClass("jqOpened")),typeof t=="function"&&t.call(this)})};window.microsoft.advertising.DepMngr.define("core.Widget",["core.EventManager","helpers.utils","helpers.GuidGenerator"],function(n,t,i){"use strict";function r(u,f,e){var s,o,h;if(!(this instanceof r))throw new Error("A child class of Widget has to be instantiated with a new operator");if(this.constructor===r)throw new Error("Cannot instantiate abstract class Widget");s=this._utils=t,this._container=null,this._assets={},this._properties={},this._eventManager=null,this._guidGenerator=null,this._STATES={INITIALIZED:0,RENDERED:1,DESTROYED:2},this._state=null;if(s.isUndefinedOrNull(f))throw new Error("InvalidArgumentException: 'properties' was null or undefined");if(!this._validateProperties(f))throw new Error("InvalidArgumentException: 'properties' was invalid");this._setProperties(f);if(s.isUndefinedOrNull(u))throw new Error("InvalidArgumentException: 'assets' was null or undefined");o=this._validateAssets(u);if(!o||typeof o=="string"){h=o?o:"InvalidArgumentException: 'assets' was invalid";throw new Error(h);}this._setAssets(u);if(s.isUndefinedOrNull(e)||typeof e=="string"&&!document.getElementById(e)||typeof e=="object"&&typeof e.nodeType!="number")throw new Error("InvalidArgumentException: parameter 'container' was invalid");this._container=typeof e=="object"?e:document.getElementById(e),this._eventManager=new n(this._getSupportedEvents(),this),this._guidGenerator=new i,this._state=this._STATES.INITIALIZED}return r.prototype._validateAssets=function(){throw new Error("NotImplementedException: Widget._validateAssets");},r.prototype._setAssets=function(){throw new Error("NotImplementedException: Widget._setAssets");},r.prototype._validateProperties=function(){throw new Error("NotImplementedException: Widget._validateProperties");},r.prototype._setProperties=function(){throw new Error("NotImplementedException: Widget._setProperties");},r.prototype._getSupportedEvents=function(){return[]},r.prototype._createView=function(){throw new Error("NotImplementedException: Widget._createView");},r.prototype._wireEvents=function(){throw new Error("NotImplementedException: Widget._wireEvents");},r.prototype._syncView=function(){throw new Error("NotImplementedException: Widget._syncView");},r.prototype.addEventListener=function(n,t){this._eventManager.addEventListener(n,t)},r.prototype.removeEventListener=function(n,t){this._eventManager.removeEventListener(n,t)},r.prototype.getEventsList=function(){return this._eventManager.getEventsList()},r.prototype.getEventObjectsList=function(){return this._eventManager.getEventObjectsList()},r.prototype.fireEvent=function(n,t,i){return this._eventManager.fireEvent(n,t,i)},r.prototype.render=function(){if(this._state===this._STATES.INITIALIZED)this._createView(),this._wireEvents(),this._syncView(),this._state=this._STATES.RENDERED;else throw new Error("IllegalStateException: Called render() while Widget was in invalid state");},r.prototype.refresh=function(){if(this._state===this._STATES.RENDERED)this._syncView();else throw new Error("IllegalStateException: Called refresh() while Widget was in invalid state");},r.prototype.destroy=function(){this._eventManager!==null&&this._eventManager.destroy(),this._eventManager=null,this._state=this._STATES.DESTROYED},r});window.microsoft.advertising.DepMngr.define("core.TileWidget",["core.Widget","helpers.utils"],function(n,t){"use strict";function i(t,r,u){if(!(this instanceof i))throw new Error("A child class of TileWidget has to be instantiated with a new operator");n.call(this,t,r,u),this._STATES.DEFAULT=1,this._STATES.EXPANDED=3,this._STATES.HIDDEN=4,this._Deferred=jQuery.Deferred}return t.inherits(i,n),i.prototype._syncView=function(){},i.prototype._getAsyncDataFromAssets=function(n){n(this._assets)},i.prototype._getSupportedEvents=function(){return[{name:"openUrl",category:"interaction"},{name:"click",category:"interaction"},{name:"mouseenter",category:"interaction"},{name:"mouseleave",category:"interaction"},{name:"stateChange",category:"interaction"},{name:"closed",category:"interaction"}]},i.prototype._validateProperties=function(){return!0},i.prototype._setProperties=function(n){this._properties=n},i.prototype.render=function(){if(this._state===this._STATES.INITIALIZED){var t=new this._Deferred,n=this;return this._getAsyncDataFromAssets(function(i){try{n._data=i,n._createView(),n._wireEvents(),n._syncView(),n._state=n._STATES.RENDERED,t.resolve()}catch(r){t.reject(r.message)}},function(n){t.reject(n)}),t.promise()}throw new Error("IllegalStateException: Called render() while TileWidget was in invalid state");},i.prototype.getSize=function(){throw new Error("NotImplementedException: TileWidget.getSize");},i.prototype.getId=function(){return this._guidGenerator.getGuid()},i.prototype.show=function(){var n=this._state;if(n===this._STATES.INITIALIZED||n===this._STATES.DESTROYED)throw new Error("IllegalStateException: Called show() while TileWidget is in invalid state");n!==this._STATES.DEFAULT&&(this._state=this._STATES.DEFAULT,jQuery(this._container).css("display","block"),this.fireEvent("stateChange",this,{oldState:n,newState:this._state}))},i.prototype.hide=function(){var n=this._state;if(n===this._STATES.INITIALIZED||n===this._STATES.DESTROYED)throw new Error("IllegalStateException: Called hide() while TileWidget is in invalid state");n!==this._STATES.HIDDEN&&(this._state=this._STATES.HIDDEN,jQuery(this._container).css("display","none"),this.fireEvent("stateChange",this,{oldState:n,newState:this._state}))},i.prototype.expand=function(){throw new Error("NotImplementedException: TileWidget.expand");},i.prototype.collapse=function(){throw new Error("NotImplementedException: TileWidget.collapse");},i.prototype.peekUp=function(){throw new Error("NotImplementedException: TileWidget.peekUp");},i.prototype.peekDown=function(){throw new Error("NotImplementedException: TileWidget.peekDown");},i.prototype.getState=function(){return this._state},i});window.microsoft.advertising.DepMngr.define("core.ExpandableTileWidget",["core.TileWidget","helpers.utils"],function(n,t){"use strict";function i(t,r,u,f){if(!(this instanceof i))throw new Error("A child class of ExpandableTileWidget has to be instantiated with a new operator");n.call(this,t,r,u),this._$peekable=!1,this._peeked=!1,this._$closeButton=!1,this._FlyoutClass=f}return t.inherits(i,n),i.prototype._createFlyout=function(){if(this._FlyoutClass){var t=document.createElement("div"),n=this._flyout=new this._FlyoutClass(this._assets,this._properties,t);return n.render(),n}return null},i.prototype._wireEvents=function(){var n=this,t=this._curl,i=this._$closeButton;jQuery(this._container).on("click",function(){var r="",i={};t&&(i.tileLandingUrl=t,i.log=n._getTrackingArgs("click","adbarclickthrus")),r=!n._FlyoutClass&&t?"openUrl":"click",n.fireEvent(r,n,i)});jQuery(this._container).on("mouseenter",function(){n.fireEvent("mouseenter",n,{})});jQuery(this._container).on("mouseleave",function(){jQuery(this).removeClass("hovered"),n.fireEvent("mouseleave",n,{})});i!==!1&&i.click(function(t){t.preventDefault(),t.stopPropagation(),n.fireEvent("closed",n,n._getTrackingArgs("click","cancel"))})},i.prototype._getTrackingArgs=function(){return},i.prototype.expand=function(n){var i=this._state,t;i!==this._STATES.EXPANDED&&(t=this._flyout?this._flyout:this._createFlyout(),this.peekUp(),t&&(this._state=this._STATES.EXPANDED,jQuery(this._container).addClass("clicked"),this.fireEvent("stateChange",this,{prevState:i,state:this._state,flyout:t,log:this._getTrackingArgs(n,"preview")})))},i.prototype.collapse=function(){var n=this._state;jQuery(this._container).removeClass("clicked"),n!==this._STATES.DEFAULT&&(this._state=this._STATES.DEFAULT,this.peekDown(),this.fireEvent("stateChange",this,{prevState:n,state:this._state}))},i.prototype.peekUp=function(){jQuery(this._container).addClass("hovered"),this._$peekable===!1||this._peeked||(this._$peekable.peekAnimate({direction:"up"}),this._peeked=!0)},i.prototype.peekDown=function(){jQuery(this._container).removeClass("hovered"),this._$peekable!==!1&&this._peeked&&(this._$peekable.peekAnimate({direction:"down"}),this._peeked=!1)},i});window.microsoft.advertising.DepMngr.define("core.FlyoutWidget",["core.Widget","helpers.utils"],function(n,t){"use strict";function i(t,r,u){if(!(this instanceof i))throw new Error("A child class of FlyoutWidget has to be instantiated with a new operator");n.call(this,t,r,u),this._STATES.OPENED=3,this._STATES.CLOSED=4}return t.inherits(i,n),i.prototype._getSupportedEvents=function(){return[{name:"openUrl",category:"interaction"},{name:"email",category:"interaction"},{name:"mouseenter",category:"interaction"},{name:"mouseleave",category:"interaction"},{name:"closed",category:"interaction"},{name:"log",category:"interaction"},{name:"close",category:"interaction"}]},i.prototype._syncView=function(){},i.prototype._wireEvents=function(){var n=this;jQuery(this._container).on("mouseenter",function(){n.fireEvent("mouseenter",n,{})});jQuery(this._container).on("mouseleave",function(){n.fireEvent("mouseleave",n,{})})},i.prototype._validateProperties=function(){return!0},i.prototype._setProperties=function(n){this._properties=n},i.prototype.getDOMContent=function(){return this._container},i.prototype.show=function(n){this._state=this._STATES.OPENED,jQuery(n).append(this._container),jQuery(this._container).children().previewAnimate({direction:"open"})},i.prototype.hide=function(){this._state=this._STATES.CLOSED,jQuery(this._container).children().previewAnimate({direction:"close"})},i.prototype.getSize=function(){throw new Error("A child class of FlyoutWidget needs to implement getSize");},i});window.microsoft.createNS("microsoft.advertising.renderer").IframeHandler=function(){"use strict";function o(n){i.contentWindow.postMessage(JSON.stringify(n),t)}function c(){var n={width:a+"px",left:"auto",overflow:"hidden",height:e,"z-index":rt};s.css(n).parent().css("overflow","hidden"),jQuery(document).off("click keydown contextmenu",p)}function p(){c(),o({action:"collapse",geom:r()})}function ft(t){var c,v,y,i={overflow:"visible","z-index":b},l=!1;t.dim&&(c=t.dim.l,v=t.dim.r,y=t.dim.b,typeof c!="number"||c>n.l?typeof v!="number"||v>n.r||(i.width=a+v+"px",i.left="0px",i.right="auto",l=!0):(i.width=a+c+"px",i.left=-1*c+"px",l=!0),typeof y!="number"||y>n.b||(i.height=e+y,l=!0));if(l){s.css(i).parent().css("overflow","visible");if(t.meta&&t.meta.useLightDismiss)jQuery(document).on("click keydown contextmenu",p);o({action:"notify_expanded",geom:r()}),h=f.EXPANDED,u.expanded()}else o({action:"failed",reason:"Bad dimensions"})}function ut(){var n=i.getBoundingClientRect(),u=typeof y=="function"?y():!0,t=u?1:0;return{t:n.top,b:n.bottom,l:n.left,r:n.right,h:n.height||e,w:n.width||it,z:i.style.zIndex,xiv:t,yiv:t,iv:t}}function k(){var n=window,r=n.screenY||n.screenTop||0,u=n.screenX||n.screenLeft||0,t=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,i=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,e=r+i,f=u+t;return{t:r,l:u,w:t,h:i,b:e,r:f}}function r(){var i=k(),t=ut();return w.rtl?(n.l=0,n.r=i.w-t.r):(n.r=0,n.l=t.l),{win:i,self:t,exp:n}}function d(n,e,o){var b,a,p;w=adbar.renderers.UI,b=location.protocol+"//"+location.host,i=e[0],s=e,c(),a="",p=n.payloadUrl,t=n.baseUrl,y=n.Visibility,typeof t=="string"&&(t=t.toLowerCase()),l=""+ +new Date,a=t,a[a.length-1]!=="/"&&(a+="/"),a+="wl_html/adbar_iframe.htm",a+="?rqp="+v+"#",a+="o:="+encodeURIComponent(b)+";",a+="pu:="+encodeURIComponent(p)+";",a+="t:="+(n.timeout||2e3)+";",a+="rt:="+l+";",a+="m:="+n.market+";",a+="g:="+encodeURIComponent(JSON.stringify(r()))+";",v=!v,o=o||{},u={success:o.success||function(){},error:o.error||function(){},setCreativeData:o.setCreativeData||function(){},expanded:o.expanded||function(){}},i.src=a,h=f.DEFAULT}function nt(){return h===f.EXPANDED}function g(u,f){tt=u,e=f,n.b=u-f,s.height(f),i.contentWindow.postMessage(JSON.stringify({action:"resize",geom:r()}),t)}var u={},t="",v=!0,l,i,s,a=160,b=35,rt=3,h,y,e,tt,w,n={t:0,r:0,b:0,xs:0,ys:0,l:0},f={DEFAULT:0,EXPANDED:1},it=160;jQuery(window).on("message",function(n){var s=n.originalEvent,i,e="";if(t.lastIndexOf(s.origin,0)===0){e=s.data;if(typeof e!="string"||e.indexOf(l)<0)return;try{i=JSON.parse(s.data)}catch(a){}i&&(i.action==="expand"?ft(i):i.action==="collapse"?(c(),o({action:"notify_collapsed",geom:r()}),h=f.DEFAULT):i.action==="setcreativedata"?u.setCreativeData(i.cData):i.success?u.success(i.payload):u.error(i.error))}});return{loadIframe:d,isExpanded:nt,resize:g}}();window.microsoft.createNS("microsoft.advertising.renderer").PayloadParser=function(){"use strict";function t(n,t,i,r){var u=n[t]||{},f=u[i]||[];f.push(r),u[i]=f,n[t]=u}function r(i){var y={},a=i.ad,ft=i.prm,v=a.data,ut=typeof v!="undefined",lt=ft.modules,yt=lt.length,vt=ft.useCustomEventName==="true",d=[],l=[],u,g,k,p,nt,it={},s,ct,c,ht,o,r,st,ot,b;if(ut)if(v.resetItemsShown&&v.resetItemsShown.length>0)for(l=v.resetItemsShown,c=0,ht=l.length;c<ht;c++)n[l[c]]&&(l[c]=n[l[c]].t);for(o in a)if(a.hasOwnProperty(o)){if(!ut){u=o.match(e);if(u&&u.length===4){var et=parseInt(u[1],10),tt=et-1,at=u[2],w,rt;d[tt]||(d[tt]={}),w=d[tt],w.tileNumber=et,w[at]=rt=w[at]||{},rt[u[3]]=a[o];continue}}if(vt)u=o.match(h),u&&u.length>3&&(g=u[2],k=u[1],t(it,g,k,a[o].u));else{p=f[o];if(p)for(s=0,ct=p.length;s<ct;s++)nt=p[s],g=(nt.control||"")+nt.action,k=o.lastIndexOf("TPT",0)===0?"tpt":"tr",t(it,g,k,a[o].u)}}for(s=0;s<yt;s++){r=lt[s].t;if(r==="Panel"||r==="Settings")continue;v?(st=v[r]||[],r=n[r]?n[r].t:r,ot=r==="ProductTile"||r==="DealTile"?!0:!1,y[r]={noDuplicates:ot,data:st},l.indexOf(r)>-1&&(y[r].reset=!0)):(y.hasOwnProperty(r)||(b=y[r]={},b.noDuplicates=!1,b.data=[]),b.data.push(d[s-2]))}return{assets:y,trackEvents:it}}function i(t){var i=t.prm,u=t.ad,y=i.modules,p=[],w=y.length,l,v=s,h,r,c,f,e,a;for(u.data||(l={},l.mouseenter={ModuleType:"gae",Control:"adbar",Action:"mouseenter",_meta:{_once:!0}},l.click={ModuleType:"gae",Control:"adbarclickthrus",Action:"click"},i.flexLog=l),i.flexURL=u.flex_url&&typeof u.flex_url.u=="string"?u.flex_url.u:"",i.flexLabel=u.flex_label&&typeof u.flex_label.tx=="string"?u.flex_label.tx:"",h=0;h<w;h++){r=y[h];if(r.t==="Panel"||r.t==="Settings")continue;c=n[r.t],f={},f.t={name:c&&c.t?c.t:r.t},r.f&&r.f!=="none"&&(e=r.f_bounds,f.f={name:r.f},e&&(a=e.w||e.width,typeof a=="number"&&(v=Math.max(v,a)),f.f.bounds=e)),p.push(f)}return i.modules=p,i.contextChangeInterval=parseInt(i.contextChangeInterval,10),isNaN(i.contextChangeInterval)&&(i.contextChangeInterval=3),i.interactionModel=parseInt(i.interactionModel,10),isNaN(i.interactionModel)&&(i.interactionModel=2),i.enableGLog=i.enableGLog==="true",i.BaseUrl||(i.BaseUrl="../"),i.maxFlyoutWidth=v+o,i}function u(n){var e,u,r,f,t,i;if(!n||!n.ad||!n.prm)return!1;e=n.ad,u=n.prm,t=u.modules;if(!(t instanceof Array&&t.length>0))return!1;for(r=0,f=t.length;r<f;r++){i=t[r];if(!i||typeof i.t!="string"||i.t==="")return!1}return u.dependencies?!0:!1}var s=400,o=10,e=/d(\d+)_([BEF])_(\w+)/,h=/(tr|tpt)_(\w+)_(\d)$/,n={Deal:{t:"DealTile",f:"DealFlyout"},Product:{t:"ProductTile",f:"ProductFlyout"}},f={CT:[{action:"click"}],OL:[{action:"loaded"}],MO:[{action:"mouseenter"}],RP:[{action:"onerror"}],DT:[{control:"adbar",action:"click"}],PL:[{control:"preview",action:"click"},{control:"preview",action:"mouseenter"},{control:"share",action:"click"},{control:"video",action:"play"},{control:"directions",action:"click"}],N4:[{control:"cancel",action:"click"}],Y1:[{control:"video",action:"start"}],Y2:[{control:"tile1",action:"click"}],N3:[{control:"tile2",action:"click"}],N2:[{control:"video",action:"complete"}],ET:[{action:"deepengage"}],Y3:[{control:"video",action:"pause"},{control:"tile3",action:"click"}],V25:[{control:"video",action:"firstquartile"},{control:"tile4",action:"click"}],V50:[{control:"video",action:"midpoint"}],V75:[{control:"video",action:"thirdquartile"},{control:"tile5",action:"click"}],TPTCT:[{action:"click"}],TPTOL:[{action:"loaded"}],TPTMO:[{action:"mouseenter"}],TPT1Y:[{control:"video",action:"start"}],TPTPL:[{control:"video",action:"play"}],TPT2Y:[{control:"tile1",action:"click"}],TPT3N:[{control:"tile2",action:"click"}],TPTET:[{action:"deepengage"}],TPT3Y:[{control:"video",action:"pause"},{control:"tile3",action:"click"}],TPTV25:[{control:"video",action:"firstquartile"},{control:"tile4",action:"click"}],TPTV50:[{control:"video",action:"midpoint"}],TPTV75:[{control:"video",action:"thirdquartile"},{control:"tile5",action:"click"}],TPT2N:[{control:"video",action:"complete"}],TPTDT:[{control:"adbar",action:"click"}]};return{parse:function(n){if(!u(n))throw new Error("Invalid Payload");var t=r(n);return{assets:t.assets,trackEvents:t.trackEvents,prm:i(n)}}}}();window.microsoft.createNS("microsoft.advertising.renderer").AdWidgetController=function(){"use strict";var n=[],t={};return{add:function(i){var u=i.widget,f=u.getId(),r=n.length===0?null:t[n[n.length-1]];i.size=u.getSize(),i.visible=!0,i.top=r?r.top+r.size.height+5:0,t[f]=i,n.push(f)},get:function(n){return t[n.getId()]},replace:function(i,r){var s=i.widget.getId(),h=n.indexOf(s),o=r.widget,c=o.getId(),u,e,f;for(n[h]=c,delete t[s],r.size=o.getSize(),r.visible=!0,t[c]=r,u=h;u<n.length;u++)e=n[u],f=u>=0?t[n[u-1]]:null,t[e].top=f?f.top+f.size.height:0},clear:function(){n=[],t={}},each:function(i,r){var u;if(r)for(u=n.length-1;u>=0;u--)i(t[n[u]]);else for(u=0;u<n.length;u++)i(t[n[u]])},remove:function(i){for(var o=i.getId(),e=!1,f=null,u=null,r=0;r<n.length;r++)n[r]===o&&(e=!0,n.splice(r,1)),u=t[n[r]],u&&e&&(u.top=f?f.top+f.size.height+5:0),f=u;delete t[o]}}}();window.microsoft.createNS("microsoft.advertising.renderer").AssetBag=function(){"use strict";function n(t){var e,f,u,i,r;if(!(this instanceof n))return new n(t);e={};for(f in t)if(t.hasOwnProperty(f)){u=t[f],i=e[f]={noDuplicates:u.noDuplicates,items:u.data,reset:u.reset};if(i.noDuplicates)for(i.used={},i.counter=0,i.max=i.items.length,r=i.items.length-1;r>=0;r--)if(typeof i.items[r].Id=="undefined")throw new Error("A non duplicate asset type should have Id attribute for all its assets");}this._assetBag=e}return n.prototype.getNext=function(n){var t=this._assetBag[n],i;if(!t)throw new Error("The given asset type ("+n+") is not available");return t.items.length>0?(i=t.items.shift(),t.noDuplicates?(t.used[i.Id]=i,t.counter<t.max&&(t.counter+=1)):t.items.push(i),i):null},n.prototype.free=function(n,t){var i=this._assetBag[n];if(!i)throw new Error("The given asset type ("+n+") is not available");if(i.noDuplicates){if(!i.used.hasOwnProperty(t))throw new Error("The given asset id ("+t+") for the asset type ("+n+") is either freed or not present in the assetBag");i.items.push(i.used[t]),delete i.used[t]}},n.prototype.getCount=function(n){var t=this._assetBag[n];return!t||typeof t.counter=="undefined"?null:t.counter},n}(),window.microsoft.createNS("microsoft.advertising.renderer").AssetController=function(){"use strict";function r(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}function i(){var f=window.localStorage,u,i,t,e,r;if(f){u=f.getItem("msads_types");if(u)for(i=u.split(","),t=0,e=i.length;t<e;t++)r=f.getItem("msads_"+i[t]),r&&(n[i[t]]=parseInt(r,10))}}var n={},t;return{getNext:function(i){if(!t)throw new Error("AssetController is not initialized yet");var r=t.getNext(i);return window.localStorage&&window.localStorage.setItem("msads_"+i,n[i]+t.getCount(i)),r},free:function(n,i){if(!t)throw new Error("AssetController is not initialized yet");t.free(n,i)},getCount:function(u){r(n)&&i();if(!t&&typeof n[u]=="undefined")return null;var e=t?t.getCount(u)||0:0,f=n[u]?n[u]:0;return e+f},refresh:function(u){var e=t?t._assetBag:{},f,s,o;for(f in e)e.hasOwnProperty(f)&&(n[f]=n[f]?n[f]+e[f].counter:e[f].counter);r(n)&&i(),t=u,e=u._assetBag;for(f in e)e.hasOwnProperty(f)&&((!n[f]||e[f].reset)&&(n[f]=0),s=n[f]+e[f].counter,window.localStorage&&(o=window.localStorage.getItem("msads_types")||"",o.indexOf(f)===-1&&(o+=o.length>0?","+f:f,window.localStorage.setItem("msads_types",o)),window.localStorage.setItem("msads_"+f,s)))}}}();window.microsoft.createNS("microsoft.advertising.renderers").AdFooter=function(){"use strict";function i(n,i){var u=n._properties,r=u.GBING||t;r+="/"+e+"/",r+=u.CID,r+="?Action="+i,r+="&ANID="+u.ANID,r+="&MUID="+u.MUID,r+="&ASID="+u.ASID,window.ORMMA.request(r,"ignore")}function r(n){var i={};try{typeof n=="string"&&(n=JSON.parse(n)),i.ASID=n.ASID||"",i.ANID=n.ANID||"",i.MUID=n.MUID||"",i.CID=n.CID||"",i.GBING=n.GBING||t,i.showIAF=n.DISABLEIAF==="0"&&adbar.renderers.UI.showIAF}catch(r){}return i}function n(n,t,i){this._container=typeof t=="object"?t:document.getElementById(t),this._setProperties(n),this.fireEvent=i}var t="https://g.bing.com",e="feedback",f="like",u="dislike";return n.prototype._setProperties=function(n){this._properties={};if(!n)return;var t=n.cData;t&&(this._properties=r(t))},n.prototype._wireEvents=function(){var n=this;jQuery(this._container).find(".iafX").click(function(){i(n,u),n.fireEvent({check:!1})}).parent().find(".iafCheck").click(function(){i(n,f),jQuery(this).parent().css("display","none").siblings(".choicesContainer").css("display","none").siblings(".iafThanksContainer").css("display","block")})},n.prototype._syncView=function(){var n=adbar.renderers.UI,t=this._properties.showIAF?"block":"none";jQuery(this._container).find(".choicesContainer").css("display","block").find("a").attr("href",n.ADCHOICESGLINK).filter("#intl_adChoiceLink").html(n.ADCHOICES).parent().siblings(".iafContainer").css("display",t).children(".iafX").attr("title",n.IAFXTOOLTIP).siblings(".iafCheck").attr("title",n.IAFCHECKTOOLTIP).parent().siblings(".iafThanksContainer").css("display","none").html(n.IAFTHANKS)},n.prototype._createView=function(){var n=adbar.renderers.UI,t="<div class='choicesContainer'><a id='intl_adChoiceLink' href='"+n.ADCHOICESGLINK+"' class='choiceslabel' target='_blank'>"+n.ADCHOICES+"</a><a id='intl_adChoiceIcon' href='"+n.ADCHOICESGLINK+"' class='choices' target='_blank'></a></div><div class='iafContainer'><div class='iafX' /><div class='iafCheck' /></div><div class='iafThanksContainer'>"+n.IAFTHANKS+"</div>";jQuery(this._container).append(t)},n.prototype.render=function(){this._createView(),this._wireEvents(),this._syncView()},n.prototype.refresh=function(){this._syncView()},n}();window.microsoft.createNS("microsoft.advertising.renderers").FeedbackWidget=function(){"use strict";function n(n){var t=adbar.renderers.UI,i="<div class='heading'>"+t.IAFTHANKS+"</div>";n=typeof n=="object"?n:document.getElementById(n),i+="<div class='text'>"+t.FEEDBACKHELPS+"</div>",i+="<div class='text'><a href='"+t.TELLUSMORELINK+"' target='_blank'>"+t.TELLUSMORELINKTEXT+"</a>&nbsp;"+t.TELLUSMORETEXT+"</div>",i+="<div class='msftLogo'></div>",jQuery(n).append(i)}return{render:n}}();window.microsoft.createNS("microsoft.advertising.renderers").AdNoticeTile=function(){"use strict";function n(t,i){if(!(this instanceof n))return new n(t);this._container=typeof t=="object"?t:document.getElementById("container"),this._clickHandler=i||function(){}}function r(){if(!t){var i=window.microsoft.getNS("microsoft.advertising.renderers").AdNoticeFlyout,n=document.createElement("div");t=new i(n),t.render()}return t}var i=!1,t=null;return n.prototype._createView=function(){jQuery(this._container).text(adbar.renderers.UI.ADNOTICETILETEXT)},n.prototype._wireEvents=function(){var n=this;jQuery(this._container).on("mouseenter",function(){i||jQuery(this).addClass("hovered")}).on("mouseleave",function(){jQuery(this).removeClass("hovered")}).on("click",function(){if(!i){jQuery(this).removeClass("hovered").addClass("clicked");var t=r();n._clickHandler(t),i=!0}})},n.prototype.render=function(){this._createView(),this._wireEvents()},n.prototype.collapse=function(){i=!1,jQuery(this._container).removeClass("hovered").removeClass("clicked")},n}();window.microsoft.createNS("microsoft.advertising.renderers").AdNoticeFlyout=function(){"use strict";function n(t){if(!(this instanceof n))return new n(t);this._container=typeof t=="object"?t:document.getElementById(t)}return n.prototype._createView=function(){var n=adbar.renderers.UI,r=n.ADNOTICETITLE,u=n.ADNOTICETEXT,t=n.ADNOTICECLICKTEXT,i="<div class='module preview adnotice'><div class= 'main t_tc'>"+r+"</div><div class= 'text'>"+u+"</div><div class='clickbox t_tc'>"+t+"</div></div>";jQuery(this._container).append(i)},n.prototype._wireEvents=function(){n.uber._wireEvents.call(this);var i=jQuery(this._container),r=i.find("div.clickbox"),t=this;r.on("click",function(){t.fireEvent("openUrl",t,{tileLandingUrl:adbar.renderers.UI.ADCHOICESGLINK})})},n.prototype.show=function(n){jQuery(n).append(this._container),jQuery(this._container).children().previewAnimate({direction:"open"})},n.prototype.hide=function(){jQuery(this._container).children().previewAnimate({direction:"close"})},n.prototype.render=function(){this._createView()},n}();window.microsoft.createNS("microsoft.advertising.renderers").adBar=function(){"use strict";function d(){t.children().css("z-index","-1")}function l(t,i,r){var e,o,f;i=i||{},f={},g=!!i.autoRefresh,nt(),h&&(i.SDN&&(f.SDN=i.SDN),i.SCT&&(f.SCT=i.SCT),t&&t.length>0&&(f.WLV=t.substring(0,1).toUpperCase())),o=new Date,e=u?(o-u)/1e3:null,(r||e===null||isNaN(c)||e>c)&&(u=o,ht(),ot(),kt(r||n.payloadURL,f))}function ht(n){s._setProperties({cData:n}),s.refresh()}function fi(n){ht(n)}function nt(){o&&o.collapse(),tt&&(tt.hide(),e.hide()),jQuery(document).off("click keydown contextmenu",rt)}function rt(n){n.target.id!=="adPreview"&&nt()}function it(){ot();var t=adbar.renderers.UI.autoRefreshInterval;typeof t!="number"||g||typeof n.Visibility!="function"||(v=setTimeout(lt,t))}function ot(){v!==null&&(clearTimeout(v),v=null)}function ei(u){var f=null,c=".adbar_if,.footer",s;h&&(c+=",.adNoticeTile",o||(f=document.createElement("div"),f.className="adNoticeTile",s=window.microsoft.getNS("microsoft.advertising.renderers").AdNoticeTile,o=new s(f,function(n){if(!e){var t={bottom:ut};adbar.renderers.UI.rtl?t.left="170px":t.right="170px",e=jQuery("<div id='adPreview'></div>").css(t).appendTo(st)}n&&(tt=n,e.empty(),n.show(e),e.show(),setTimeout(function(){jQuery(document).on("click keydown contextmenu",rt)},1))}),o.render(),t.append(f))),y(),d(),t.children(c).css("z-index","3"),r=i.RENDERED,u.raf&&n&&n.PublisherObject&&typeof n.PublisherObject.adLoaded=="function"&&n.PublisherObject.adLoaded(),it()}function ri(t){var i,r;if(t&&t.code==="NoAd"){typeof c!="number"&&(c=3),i=t.fbu,(typeof i!="string"||i.indexOf("https")!==0)&&(i=n.fbu),l(null,{autoRefresh:g},i);return}r={ExceptionType:"Exception",Message:"Error loading payload",_meta:{_noAsid:!0}},t&&t.errorText==="timeout"&&(r.ExceptionType="Timeout"),et(r),it()}function et(n){u-=c,u<0&&(u=0),r===i.INITIALIZED&&(y(),w.empty().append("<div class='contentNA'></div>"),d(),w.css("z-index","1"),t.append(w)),n&&gt.logEvent(n)}function ft(n){var t=window.ORMMA.STATES;try{switch(n){case t.SUSPENDED:(r===i.DEFAULT||r===i.EXPANDED)&&bt();break;case t.DEFAULT:r===i.INITIALIZED?l():r===i.HIDDEN&&(dt(),r=i.DEFAULT);break;case t.HIDDEN:vt(),r=i.HIDDEN}}catch(u){et({ExceptionType:"Exception",Message:"CriticalError:"+u.message})}}function ui(){nt()}function y(n){var i=null;i=n?n.data:window.ORMMA.getSize(),a=i.height,k=a-ut,h&&(k-=ti),b.resize(a,k),t.height(a)}function dt(){}function vt(){}function bt(){}function kt(t,i){var r,f,u;for(r in i)i.hasOwnProperty(r)&&(t+="&"+r+"="+encodeURIComponent(i[r]));f={timeout:n.timeout,baseUrl:n.BaseUrl,payloadUrl:t,market:n.Market,isVisible:n.Visibility},u={error:ri,success:ei,setCreativeData:fi,expanded:ui},b.loadIframe(f,ct,u)}function wt(){if(!f){f=document.createElement("div"),f.className="feedback";var n=window.microsoft.getNS("microsoft.advertising.renderers").FeedbackWidget;n.render(f),t.append(f)}d(),f.style.zIndex="1"}function lt(){var r=new Date,i=adbar.renderers.UI.autoRefreshInterval,t;if(typeof i!="number"||typeof n.Visibility!="function")return;t=!b.isExpanded(),t=t&&n.Visibility(),t=t&&r-u>=i,t&&l(null,{autoRefresh:!0})}function at(i){var r=window.ORMMA,e=i.EventManager,c=i.Market,o,u,f;n=i,t.append(w).append(ct).append(ii),st=jQuery("#"+i.ContainerID).append(t),o=window.microsoft.getNS("microsoft.advertising.renderers").AdFooter,p=document.createElement("div"),p.className="footer",s=new o({},p,function(n){var t=n.check;t||wt()}),s.render(),t.append(p),u=new Date,f=i.BaseUrl+"wl_html/lang/lang-"+c+".js",f+="?dt="+u.getFullYear()+u.getMonth()+u.getDate(),jQuery.ajax({url:f,dataType:"script",cache:!0,success:function(){h=adbar.renderers.UI.useSDN&&n.target,s.refresh()}}),h=adbar.renderers.UI.useSDN&&n.target,r&&(r.addEventListener(r.EVENTS.STATECHANGE,ft),r.addEventListener(r.EVENTS.SIZECHANGE,y)),ni.load(["helpers.utils"],function(n){n.isCSS3Supported&&jQuery("html").addClass("useCss3")}),e&&e.addEventListener("contextChange",l)}function pt(){l()}function yt(){window.ORMMA.removeEventListener(window.ORMMA.EVENTS.STATECHANGE,ft),window.ORMMA.removeEventListener(window.ORMMA.EVENTS.SIZECHANGE,y)}var i={INITIALIZED:0,DEFAULT:1,RENDERED:1,EXPANDED:2,HIDDEN:3,SUSPEND:4},r=i.INITIALIZED,ti=26,ut=31,st=null,ct=jQuery("<iframe class='adbar_if' allowTransparency='true' scrolling='no' src='' frameborder='0'></iframe>"),w=jQuery("<div class='innerContainer'></div>"),t=jQuery("<div class='adBar container'></div>"),ii=jQuery("<div class='adBarLoading'></div>"),f=null,s=null,p=null,o=null,e=null,tt=null,h=adbar.renderers.UI.useSDN,n=null,u,v=null,g=!1,c=3,a,k,gt=microsoft.advertising.Logger,ni=microsoft.advertising.DepMngr,b=microsoft.advertising.renderer.IframeHandler;return{init:at,renderAd:pt,dispose:yt}}();function adBarLoad(){"use strict";function a(){var r={},n=window.location.search,t,u,i;if(n.length>1)for(n=n.substring(1).split("&"),t=0,u=n.length;t<u;t++)i=n[t].split("="),r[decodeURIComponent(i[0])]=decodeURIComponent(i[1]);return r}function h(){var n=document.cookie,f=escape(i(n,"mh",";")),t=escape(i(i(n,"ANON",";"),"A","&")),r=escape(i(n,"MUID",";")),u=escape(i(n,"TOptOut",";"));return t===""&&(t=r),{PN:f,ID:t,MUID:r,TOPT:u}}function i(n,t,i){var u,r;if(n!==null){u=n.toLowerCase().indexOf(t.toLowerCase()+"=");if(u!==-1)return u+=t.length+1,r=n.indexOf(i,u),r=r===-1?n.length:r,n.substring(u,r)}return""}function o(n){var r="",t,i;if(!n)return"";for(t in n)n.hasOwnProperty(t)&&(i=n[t],i&&(r+="&"+t+"="+i));return r}function s(n){var t=u,i=n.split("-");return i.length<2||(t=i[1]+i[0],t=t.toUpperCase()),t}function e(n,t){var i="";return i=typeof n=="string"&&n.toLowerCase()==="dogfood"?r.df:t===u?r.prod_usen:r.prod,i+=t}var t,f,n=window.ORMMA,c="OEX2",l="adto",u="USEN",r={prod:"WAB2",prod_usen:"OVT2",df:"WAB"},v=2e3;if(window.wLive&&typeof window.wLive!="object")return;window.wLive=f=window.wLive||{},f.adbar=t={},t.show=function(){n.show()},t.hide=function(){n.hide()},t.suspend=function(){n.suspend()},t.resize=function(t,i){n.resize(t,i)},t.expand=function(){},t.init=function(t){function y(){jQuery("#"+t.ContainerID).append("<div class='adBar container' style='height:"+t.Height+"px'><div class='module info'></div></div>");var n=t.PublisherObject.adErrorEventHandler;n&&typeof(n==="function")&&n()}var p=h(),i=t.Market,b=o(p),d="https://fd.rad.msn.com/v3/delivery/DisplayFD?GetSAd=&rafb=2&jsontype=callback&DACSPNID=adbar&jsonp=GETADR",w,u,k,r,f;if(!t.Width||!t.Height||!t.ContainerID||typeof i!="string"||!t.EventManager||typeof t.EventManager.addEventListener!="function"||typeof t.EventManager.removeEventListener!="function")throw new Error("Invalid configuration data.");w=s(i),t.payloadURL=d+"&PG="+e(t.Environment,w)+b,t.fbu=d+"&PG="+c+w+b,u=p.TOPT,t.TOPT=p.TOPT,t.target=u===""||u==="2",t.target=!0,t.timeout=v,k=a(),r=parseInt(k[l],10),isNaN(r)||(t.timeout=r),window.microsoft.advertising.DepMngr.load(["helpers.utils"],function(n){var f=t.BaseUrl+"wl_html/content/";n.loadCss(f+"adBar.css"),(i==="ja-jp"||i==="zh-tw")&&n.loadCss(f+"adBar-"+i+".css");if(jQuery.browser.msie){var r=parseInt(jQuery.browser.version,10)||9,u=document.documentMode,e="adBar-ie";r<9&&(typeof u!="undefined"&&u!==r&&(r=u),e+=r+".css",n.loadCss(f+e))}});if(!n||!n.supports(n.FEATURES.LEVEL2)){y();return}try{n.init({wlOptions:{width:t.Width,height:t.Height,offsetLeft:530},PublisherObject:t.PublisherObject})}catch(g){y();return}n.addEventListener(n.EVENTS.ERROR,y),n.addEventListener(n.EVENTS.ADERROR,function(){}),f=window.microsoft.advertising.renderers.adBar;if(typeof f!="object")throw new Error("Framework internal error: panel renderer is not available.");f.init(t)}}adBarLoad()