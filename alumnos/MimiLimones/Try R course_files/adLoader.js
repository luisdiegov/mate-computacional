(function(){"use strict";window.microsoft||(window.microsoft={});var n=window.microsoft;n.createNS=function(n,t){var u,r,i;if(typeof n!="string"||n.length===0)throw new Error("Namespace has to be not empty string.");for(t=t||window,u=n.split("."),r=0;r<u.length;r++){i=u[r],typeof t[i]=="undefined"&&(t[i]={});if(typeof t[i]!="object")throw new Error("Namespace cannot be create, part of it already exists and it is not an object.");t=t[i]}return t},n.getNS=function(n,t){var u,i,r;if(typeof n!="string"||n.length===0)throw new Error("Namespace has to be not empty string.");for(t=t||window,u=n.split("."),i=0;i<u.length;i++){r=u[i];if(typeof t[r]!="object")return null;t=t[r]}return t},n.doesNSExist=function(t,i){return n.getNS(t,i)!==null},n.getCtor=function(t,i){if(typeof t!="string"||t.length===0)throw new Error("Constructor has to be not empty string.");i=i||window;if(t.indexOf(".")>-1){var r=t.split(".");t=r[r.length-1],i=n.getNS(r.slice(0,r.length-1).join("."),i)}if(i===null)throw new Error("Constructor cannot be fetched, namespace does not exist.");if(typeof i[t]!="function")throw new Error("Constructor cannot be fetched, it is not a function.");return i[t]}})();window.microsoft.createNS("microsoft.advertising.sdk.sf").ext=function(n){"use strict";function o(n,t){typeof e=="function"&&e(n,t)}function h(n){var f,r;switch(n.action){case"collapse":f="collapsed",u=i.DEFAULT,t=n.geom,r="";break;case"resize":f="geom-update",r=t=n.geom;break;case"notify_collapsed":f="collapsed",u=i.DEFAULT;break;case"notify_expanded":f="expanded",r=t=n.geom,u=i.EXPANDED;break;case"failed":f="failed",r=t=n.geom,u=i.DEFAULT,r={reason:n.reason}}o(f,r)}var f=n.hostOrigin||"",s=n.adReqTime,r={},e,t=n.geom,i={DEFAULT:0,EXPANDING:1,EXPANDED:2},u=i.DEFAULT;r.expand=function(n,t){if(!n||!n.l&&!n.r&&!n.b){o("failed",{reason:"Bad dimensions passed in"});return}if(u!==i.DEFAULT)return;u=i.EXPANDING;var r={action:"expand",dim:n,meta:t,reqTime:s};window.parent.postMessage(JSON.stringify(r),f)},r.register=function(n,t,i){e=typeof i=="function"?i:function(){}},r.geom=function(){return t||{}},r.supports=function(){return{"exp-ovr":!0,"exp-push":!1,"read-cookie":!1,"write-cookie":!1}},r.collapse=function(){if(u===i.DEFAULT)return;var n={action:"collapse",reqTime:s};window.parent.postMessage(JSON.stringify(n),f)},r.status=function(){},r.inViewPercentage=function(){return t&&t.self&&typeof t.self.iv=="number"?t.self.iv*100:1},window.$sf=window.sf={ext:r};jQuery(window).on("message",function(n){var r=n.originalEvent,i,t="";if(f.lastIndexOf(r.origin,0)===0){t=r.data;if(typeof t=="string"){try{i=JSON.parse(t)}catch(u){}h(i)}}})};(function(){"use strict";function n(n){var t={success:!1,reqTime:r};t.error=n!==null&&typeof n=="object"?n:{errorText:n||"Exception"},window.parent.postMessage(JSON.stringify(t),i)}function o(n){var t;n=n||{},n.creativeData=y,t={success:!0,payload:n,reqTime:r},window.parent.postMessage(JSON.stringify(t),i)}function c(n){for(var u={},r=n.split(";"),i,t=0;t<r.length;t++)i=r[t].split(":="),i.length===2&&(u[i[0]]=decodeURIComponent(i[1]));return u}function l(n){return p.test(n)?!0:!1}function a(){var e,w=!1,a=c(window.location.hash.slice(1)),s=a.pu,b=a.t,p,y,v;i=a.o,r=a.rt,u=a.m;if(!l(s)){n();return}try{p=JSON.parse(a.g)}catch(k){p={}}y=window.microsoft.getNS("microsoft.advertising.sdk.sf")||{},typeof y.ext=="function"&&y.ext({hostOrigin:i,adReqTime:r,geom:p}),t=window.setTimeout(function(){window.GETADR=function(){},e&&e.parentNode&&e.parentNode.removeChild(e),w=!0,clearTimeout(t),n("timeout")},parseInt(b,10)),f=new Date,s+=s.lastIndexOf("?")>-1?"&":"?",s+="_="+f.getTime(),document.write("<script type='text/javascript' id='payloadScript' src='"+s+"'><\/script>"),e=document.getElementById("payloadScript"),v=function(){if(h)return;if(w)return;clearTimeout(t),o({tpc:!0})},window.addEventListener?e.addEventListener("load",v,!1):window.attachEvent?e.attachEvent("onreadystatechange",function(){/loaded|complete/.test(e.readyState)&&(v(),e.detachEvent("onreadystatechange"))}):window.onload&&(e.onload=v),e.onerror=function(){if(w)return;clearTimeout(t),n()}}var i,r="",p=/^https:(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!\$&'\(\)\*\+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,y=null,h=!1,t,f,s,v=null,e,u;window.ORMMA={request:function(n){typeof n=="string"&&document.write("<img src='"+n+"' width='1' height='1' />")}},window.setCreativeData=function(n,t){var u={action:"setcreativedata",cData:t,reqTime:r};window.parent.postMessage(JSON.stringify(u),i)},window.GETADR=function(i){var c,y,l,r,a;h=!0,c="",t&&clearTimeout(t),s=new Date,v=i,e=s-f;if(!i||i.err){n("Invalid Payload");return}if(i.error){i.error.fbu=i.fbu,n(i.error);return}for((u==="zh-tw"||u==="ja-jp")&&(y="content/adBar-"+u+".css",jQuery("<link rel='stylesheet' type='text/css' media='all' href='"+y+"'/>").appendTo("head")),l=i.rdr||[],r=0;r<l.length;r++)if(l[r].c==="wl"){c=l[r].u;break}a=c.match(/adbar\/products\/v(\d+(.\d+)?)\//),(!a||a.length<2||parseFloat(a[1])<3.1)&&(c="https://ads1.msads.net/adbar/products/v3.1/rafStitcher.js"),jQuery.ajax({url:c,dataType:"script",cache:!0,success:function(){var t=window.microsoft.getNS("microsoft.advertising.renderers.stitcher")||{};typeof t.render=="function"?t.render(i,e,function(){o({raf:!0})}):n("Error calling rendering on stitcher")},error:function(){n("Error loading RAF stitcher")}})},a()})()